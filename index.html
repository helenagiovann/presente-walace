<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jogo de Palavras â€” Surpresa</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#071024; --card:#0b1320; --muted: #b9c6db; --ok:#22c55e; --accent:#ff6b6b; --white:#eaf0ff; --reveal-blue: #3b82f6;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#041021,#071024);color:var(--white);min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}
  .wrap{width:100%;max-width:980px}
  .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:22px;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,0.6)}
  h1{margin:0;font-size:26px}
  .intro{color:var(--muted);margin-top:8px}
  .grid{
    margin-top: 18px;
    display: grid;
    grid-template-columns: 220px 1fr;
    gap: 12px;
    align-items: center;
  }
  .hint{color:var(--muted);font-size:14px}
  .cells{display:flex;gap:6px;align-items:center}
  .cell{width:44px;height:50px;border-radius:8px;background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;border:2px solid rgba(255,255,255,0.04); transition: background .4s ease, border-color .4s ease, transform .3s ease;}
  .cell.pad{background:transparent;border:none}
  .cell input{width:100%;height:100%;border:0;background:transparent;color:var(--white);text-align:center;font-weight:800;font-size:18px;outline:none}
  .cell.locked{background:linear-gradient(90deg,#083022,#095b36);border-color:rgba(34,197,94,0.9);color:var(--white)}
  .cell.vertical-reveal{background:linear-gradient(180deg, #2563eb, var(--reveal-blue)); border-color:rgba(96, 165, 250, 0.9); transform: scale(1.05); box-shadow: 0 5px 20px rgba(59, 130, 246, 0.2);}
  .status{margin-top:16px;color:var(--muted);display:flex;gap:12px;align-items:center}
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:80}
  .modal.show{display:flex}
  .backdrop{position:absolute;inset:0;background:rgba(3,6,23,0.6);backdrop-filter:blur(6px)} 
  .modal-card{position:relative;z-index:10;background:linear-gradient(180deg,#071024,#061022);padding:20px;border-radius:12px;width:90%;max-width:640px;box-shadow:0 30px 70px rgba(2,6,23,0.7);text-align:center}
  .modal-card h2{margin:0;font-size:22px}
  .modal-card p{color:var(--muted);margin-top:8px}
  .modal-actions{margin-top:14px;display:flex;gap:10px;justify-content:center}
  .btn{padding:10px 14px;border-radius:10px;border:0;font-weight:700;cursor:pointer}
  .btn-primary{background:linear-gradient(90deg,#7c5cff,#ff7ab6);color:#071024}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--white)}
  canvas{position:fixed;left:0;top:0;pointer-events:none;z-index:90}
  @media (max-width:880px){
    .grid {
      grid-template-columns: 1fr;
    }
    .hint{
      display:none
    } 
    .cell{width:38px;height:44px}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="panel">
    <h1>Cruzadinha</h1>
    <div class="intro">Preencha as palavras a partir das dicas. Quando todas estiverem corretas, serÃ¡ revelada uma surpresa!</div>
    <div class="grid" id="grid"></div>
    <div class="status"><div id="progress">0 / 8 palavras corretas</div><div style="flex:1"></div><div style="color:var(--muted)">Feliz AniversÃ¡rio!</div></div>
  </div>
</div>

<!-- modal -->
<div class="modal" id="modal">
  <div class="backdrop"></div>
  <div class="modal-card">
    <h2>ParabÃ©ns! ðŸŽ‰</h2>
    <p>VocÃª completou todas as palavras e descobriu a surpresa: <strong>SÃƒO PAULO</strong>.</p>
    <p id="countdownMessage">Calculando os dias...</p>
    <div class="modal-actions">
      <a class="btn btn-primary" id="pdfBtn" href="passagens.pdf" target="_blank">Abrir Passagens (PDF)</a>
      <a class="btn btn-ghost" id="airbnbBtn" href="https://www.airbnb.com.br/rooms/1105822847840419967?c=.pi80.pkTUVTU0FHSU5HX05FV19NRVNTQUdFX0VNQUlMX0RJR0VTVA%3D%3D&euid=8d04b15a-85ad-3f70-c0e5-a2f41f39feab&source_impression_id=p3_1754936119_P3i_RyZinkXGe7YU" target="_blank">Abrir Airbnb</a>
      <button class="btn btn-ghost" id="closeModal">Fechar</button>
    </div>
  </div>
</div>

<canvas id="confettiCanvas"></canvas>

<script>
const ROWS = [
  // Palavra:       Letra da vertical: S
  {word: 'sahur',      targetIndex: 0, hint: 'Tung Tung Tung _____'},
  // Palavra:       Letra da vertical: Ãƒ
  {word: 'vietnÃ£',     targetIndex: 5, hint: 'Bom dia, ______!'},
  // Palavra:       Letra da vertical: O
  {word: 'maio',       targetIndex: 3, hint: 'MÃªs em que vocÃª me pediu em namoro'},
  // Palavra:       Letra da vertical: P
  {word: 'crepusculo', targetIndex: 3, hint: 'Seu filme favorito (aquele de vampiros)'},
  // Palavra:       Letra da vertical: A
  {word: 'Ã¢mbar',      targetIndex: 3, hint: 'Nome da nossa futura filha'},
  // Palavra:       Letra da vertical: U
  {word: 'paysandu',   targetIndex: 7, hint: 'Nosso time de coraÃ§Ã£o/hiperfoco'},
  // Palavra:       Letra da vertical: L
  {word: 'labubu',     targetIndex: 0, hint: 'Apelido carinhoso/bichinho de pelÃºcia de chaveiro'},
  // Palavra:       Letra da vertical: O
  {word: 'durangos',   targetIndex: 6, hint: 'Bar do nosso primeiro date'}
];

const VERTICAL_COLUMN_INDEX = 7;

function normalize(s){ return s.normalize('NFD').replace(/\p{Diacritic}/gu, '').toUpperCase(); }

const grid = document.getElementById('grid');
const progress = document.getElementById('progress');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const confettiCanvas = document.getElementById('confettiCanvas');
let confettiCtx = confettiCanvas.getContext('2d');
const rowsState = [];

for(let r=0;r<ROWS.length;r++){
  const info = ROWS[r];
  const hintEl = document.createElement('div'); 
  hintEl.className='hint'; 
  hintEl.textContent = (r+1)+'. '+info.hint;
  const cellsEl = document.createElement('div'); 
  cellsEl.className='cells';
  const padding = VERTICAL_COLUMN_INDEX - info.targetIndex;
  
  for(let i=0;i<padding;i++){ const p = document.createElement('div'); p.className='cell pad'; cellsEl.appendChild(p); }
  const inputs = [];
  for(let i=0;i<info.word.length;i++){
    const cBox = document.createElement('div'); cBox.className='cell';
    const inp = document.createElement('input'); inp.setAttribute('maxlength','1'); inp.setAttribute('inputmode','text');
    inp.dataset.r = r; inp.dataset.i = i;
    inp.addEventListener('input', onInput);
    inp.addEventListener('keydown', onKeyDown);
    cBox.appendChild(inp); cellsEl.appendChild(cBox);
    inputs.push(inp);
  }
  
  grid.appendChild(hintEl);
  grid.appendChild(cellsEl);
  rowsState.push({info, inputs, locked:false});
}

function onInput(e){
  const inp = e.target;
  const r = Number(inp.dataset.r);
  const i = Number(inp.dataset.i);
  const val = normalize(inp.value);
  if(val && !/^[A-Z]$/.test(val)){ inp.value = ''; return; }
  
  if(val){ 
    inp.value = val; 
    const next = rowsState[r].inputs[i+1]; 
    if(next) next.focus(); 
  }
  checkRowComplete(r);
}

function onKeyDown(e){
  const inp = e.target;
  const r = Number(inp.dataset.r);
  const i = Number(inp.dataset.i);
  if(e.key === 'Backspace'){
    if(inp.value === ''){ 
      const prev = rowsState[r].inputs[i-1]; 
      if(prev){ 
        prev.focus(); 
        prev.value=''; 
      } 
    }
  }
}

function checkRowComplete(rowIndex){
  const state = rowsState[rowIndex];
  if(state.locked) return;
  const letters = state.inputs.map(x=>x.value || '').join('');
  if(letters.length !== state.info.word.length) return;
  
  if(normalize(letters) === normalize(state.info.word)){
    state.locked = true;
    state.inputs.forEach((inp, i) => {
      inp.value = state.info.word[i].toUpperCase();
    });
    
    state.inputs.forEach(inp => { 
      inp.disabled = true; 
      inp.parentElement.classList.add('locked'); 
    });
    updateProgress();
  } else {
    state.inputs.forEach(inp=>{ 
      inp.parentElement.style.borderColor = 'var(--accent)'; 
      setTimeout(()=>{ inp.parentElement.style.borderColor='rgba(255,255,255,0.04)'; }, 800); 
    });
  }
}

function updateProgress(){
  const correct = rowsState.filter(r=>r.locked).length;
  progress.textContent = `${correct} / ${ROWS.length} palavras corretas`;
  
  if(correct === ROWS.length){
    revealVertical();
    setTimeout(()=>{ 
      showModal(); 
      launchConfetti(); 
    }, 2000); 
  }
}

function revealVertical(){
  for(let i=0; i < rowsState.length; i++){
    const state = rowsState[i];
    const targetInputIndex = state.info.targetIndex;
    const targetCell = state.inputs[targetInputIndex].parentElement;

    setTimeout(() => {
      targetCell.classList.add('vertical-reveal');
    }, i * 100); 
  }
}

function showModal(){
  const targetDate = new Date('2025-08-22T00:00:00');
  const today = new Date();
  const diffTime = targetDate - today;
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
  const dayString = diffDays === 1 ? 'dia' : 'dias';
  const messageEl = document.getElementById('countdownMessage');
  messageEl.textContent = `Agora faÃ§a as malas porque embarcamos daqui a ${diffDays} ${dayString}!`;
  modal.classList.add('show'); 
}

closeModal.addEventListener('click', ()=> modal.classList.remove('show'));

function launchConfetti(){
  const canvas = confettiCanvas; canvas.width = innerWidth; canvas.height = innerHeight; const ctx = confettiCtx;
  let pieces = []; const colors = ['#ff7ab6','#7c5cff','#ffd66b','#7ee7ff','#c2ffb3'];
  for(let i=0;i<220;i++) pieces.push({x:Math.random()*canvas.width,y:Math.random()*-canvas.height*0.5,vy:1+Math.random()*6,vx:(Math.random()-0.5)*4,w:6+Math.random()*12,c:colors[Math.floor(Math.random()*colors.length)],r:Math.random()*360,vr:Math.random()*10});
  let running = true;
  function frame(){ ctx.clearRect(0,0,canvas.width,canvas.height); for(const p of pieces){ p.x += p.vx; p.y += p.vy; p.vy += 0.06; p.r += p.vr; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.r*Math.PI/180); ctx.fillStyle = p.c; ctx.fillRect(-p.w/2,-p.w/2,p.w,p.w*0.6); ctx.restore(); } pieces = pieces.filter(p=>p.y < canvas.height+80); if(pieces.length && running) requestAnimationFrame(frame); else ctx.clearRect(0,0,canvas.width,canvas.height); }
  frame(); setTimeout(()=>{ running=false; },9000);
}

rowsState.forEach((st, idx)=>{ st.inputs[0].addEventListener('focus', ()=> st.inputs[0].select()); });
(function focusFirst(){ for(const st of rowsState){ for(const inp of st.inputs){ if(!inp.disabled){ inp.focus(); return; } } } })();
</script>
</body>
</html>
